# HTTP 协议

- 网络基础
- 网络的服务器是基于请求（request）和响应（response）的
- 访问网址时发生了什么
  1. DNS 解析，将域名解析为 IP 地址
  2. 浏览器需要和服务器建立连接（三次握手）
  3. 浏览器向服务器发送请求（HTTP 协议）
  4. 服务器接收请求，处理请求，返回响应（HTTP 协议）
  5. 浏览器接收响应，渲染页面
  6. 断开和服务器的连接（四次挥手）
- 客户端如何和服务器建立连接（TCP / IP 协议）
  - 三次握手
    1. 客户端向服务器发送请求，请求建立连接（SYN）
    2. 服务器接收到请求，向客户端发送确认信息，确认建立连接（ACK SYN）
    3. 客户端接收到确认信息，向服务器发送确认信息，确认建立连接（ACK）
  - 四次挥手
    1. 客户端向服务器发送请求，请求断开连接（FIN）
    2. 服务器接收到请求，向客户端发送确认信息，确认断开连接（ACK）
    3. 服务器向客户端发送请求，请求断开连接（ACK FIN）
    4. 客户端接收到请求，向服务器发送确认信息，确认断开连接（ACK）
- 请求和响应实际上就是一段数据，只是这段数据遵循了一定的规则
  - 这个规则就是 HTTP 协议
- TCP / IP 协议族
  - 这组协议规定了互联网中所有通信的细节
  - 网络通信的过程由四层组成
    - 应用层：软件的层面
    - 传输层：负责对数据进行拆分，把数据分成一个个的数据包
    - 网络层：负责给数据包添加信息
    - 数据链路层：传输信息
- HTTP 协议就是应用层的协议
  - 用来规定客户端和服务器之间通信的报文格式的
- 一个服务器的主要功能
  - 可以接收到浏览器发送的请求报文
  - 可以向浏览器返回响应报文

## 请求报文（request）

- 客户端发送给服务器的报文称为请求报文
- 请求报文的格式
  - 请求首行：就是请求报文的第一行
    - 请求方法：GET / POST / PUT / DELETE / HEAD / OPTIONS / TRACE / CONNECT
      - GET：主要用来向服务器请求资源
      - POST：主要用来向服务器发送数据
    - 请求路径：表示请求资源的路径
      - `?` 后边的内容叫做查询字符串
        - 查询字符串是一个名值对结构，使用 `=` 连接
        - 多个名值对之间使用 `&` 分隔
      - GET 请求通过查询字符串将数据发送给服务器
        - 由于查询字符串会在浏览器地址栏中直接显示，所以其
          - 安全性较低
          - 由于 url 地址长度的限制，所以其传输的数据量也是有限的
      - POST 请求通过请求体将数据发送给服务器
        - 由于请求体不会在浏览器地址栏中显示，所以其
          - 安全性较高
          - 由于请求体的大小没有限制，所以其传输的数据量也是没有限制的
      - 如果需要向服务器发送数据，能用 POST 就不要用 GET
    - 协议版本：HTTP/1.1
  - 请求头
    - 用来描述请求报文的一些信息
    - 由多行字符串组成
    - 每行字符串都是一个名值对
    - 名和值之间使用 `:` 连接
    - 每个名值对之间使用 `\r\n` 进行分隔
    - 以 `\r\n` 作为结束标志
    - 每个名值对都有自己的作用
      - Host：表示请求的服务器地址
      - User-Agent：表示客户端的信息
      - Accept：表示客户端能够接收的数据类型
      - Accept-Encoding：表示客户端能够接收的压缩格式
      - Accept-Language：表示客户端能够接收的语言
      - Cookie：表示客户端携带的 cookie
      - Referer：表示客户端的来源
      - Connection：表示客户端是否需要断开连接
  - 空行
    - 用来分隔请求头和请求体
  - 请求体
    - POST 请求通过请求体将数据发送给服务器

## 响应报文（response）

- 响应首行
  - 协议版本
  - 状态码
    - 1xx：表示请求已经被接收，需要继续处理
    - 2xx：表示请求已经被成功处理
      - 200：表示请求已经被成功处理
      - 204：表示请求已经被成功处理，但是没有响应体
    - 3xx：表示请求需要重定向
      - 301：永久重定向
      - 302：临时重定向
    - 4xx：表示客户端错误
      - 400：表示客户端发送的请求报文语法错误
      - 401：表示客户端没有权限访问资源
      - 403：表示客户端没有权限访问资源
      - 404：表示客户端请求的资源不存在
    - 5xx：表示服务器错误
      - 500：表示服务器内部错误
      - 503：表示服务器暂时不可用
  - 状态码描述
- 响应头
  - 用来描述响应报文的一些信息
  - 每个名值对都有自己的作用
    - Content-Type：表示响应体的数据类型
    - Content-Length：表示响应体的大小
- 空行
  - 用来分隔响应头和响应体
- 响应体
  - 服务器返回给客户端的内容
